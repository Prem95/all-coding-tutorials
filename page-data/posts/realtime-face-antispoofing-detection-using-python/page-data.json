{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/realtime-face-antispoofing-detection-using-python","result":{"data":{"markdownRemark":{"id":"00c5a7ee-ba7a-539b-b187-ab178d2581e0","html":"<p><img src=\"https://unsplash.com/photos/zbLW0FG8XU8/download?ixid=MnwxMjA3fDB8MXxzZWFyY2h8MjZ8fGFpfGVufDB8fHx8MTYzNDk0Nzk3NQ&#x26;force=true\" alt=\"Photo by [Myke Simon](https://unsplash.com/@myke_simon?utm_source=medium&#x26;utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&#x26;utm_medium=referral)\"></p>\n<h2 id=\"what-is-machine-learning\" style=\"position:relative;\"><a href=\"#what-is-machine-learning\" aria-label=\"what is machine learning permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine Learning</a>?</h2>\n<p>It is a technology branch that allows computer systems to learn from vast amounts of data, <strong>identify patterns</strong> within images and text, and make <strong>statistical decisions</strong> with minimal human intervention.</p>\n<p>At its most basic, <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a> uses pre-programmed algorithms that receive and analyse input data to predict output values within an acceptable range.</p>\n<p>As new data is fed to these algorithms in <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a>, they learn and optimise their operations to improve performance, developing <strong><em>intelligence</em></strong> over time.</p>\n<blockquote>\n<h1 id=\"key-research-in-natural-language-processing-conversational-ai-computer-vision-reinforcement-learning-and-ai-ethics-drive-the-growth-and-exposure-of-ai\" style=\"position:relative;\"><a href=\"#key-research-in-natural-language-processing-conversational-ai-computer-vision-reinforcement-learning-and-ai-ethics-drive-the-growth-and-exposure-of-ai\" aria-label=\"key research in natural language processing conversational ai computer vision reinforcement learning and ai ethics drive the growth and exposure of ai permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><em>Key research in natural language processing, conversational AI, computer vision, reinforcement learning, and AI ethics drive the growth and exposure of AI</em></h1>\n</blockquote>\n<p><a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a> powers almost all the social media applications nowadays from YouTube, Google, Facebook, Instagram, Baidu, Twitter, etc.</p>\n<p>Even voice assistants like Siri, Google Assistant, and Alexa are powered through <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a>, particularly in NLP and Speech Recognition.</p>\n<p>The branch of <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a> is enormous, but it all started small, and understanding the fundamentals is equally essential to know what is happening behind the curtains truly.</p>\n<h2 id=\"what-is-facial-recognition\" style=\"position:relative;\"><a href=\"#what-is-facial-recognition\" aria-label=\"what is facial recognition permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is Facial Recognition?</h2>\n<p><img src=\"https://cdn-images-1.medium.com/max/12730/0*rijfxt57bqpNjSwN\" alt=\"Photo by [dogherine](https://unsplash.com/@dogherine?utm_source=medium&#x26;utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&#x26;utm_medium=referral)\"><em>Photo by <a href=\"https://unsplash.com/@dogherine?utm_source=medium&#x26;utm_medium=referral\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">dogherine</a> on <a href=\"https://unsplash.com?utm_source=medium&#x26;utm_medium=referral\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unsplash</a></em></p>\n<p>When <a href=\"https://wiseai.tech/what-is-liveness-detection-and-why-is-it-important/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Apple FaceID first came out</a>, videos and memes flooded the internet, finding ways to bypass the <strong>facial authentication system</strong>.</p>\n<p>Some have come up with creative methods, such as unlocking the phone using the owner’s face while asleep or displaying a photo of the owner into the camera.</p>\n<blockquote>\n<h1 id=\"the-best-way-to-enhance-security-is-through-facial-recognition--its-going-to-be-the-standard-very-soon\" style=\"position:relative;\"><a href=\"#the-best-way-to-enhance-security-is-through-facial-recognition--its-going-to-be-the-standard-very-soon\" aria-label=\"the best way to enhance security is through facial recognition  its going to be the standard very soon permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>“The best way to enhance security is through facial recognition — it’s going to be the standard very soon.”</h1>\n</blockquote>\n<p>The goal of <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">face recognition</a> is to extract a sequence of data representing the same face from an incoming image using a collection of training photos stored in a database. The significant challenge is ensuring that <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">face recognition</a> process occurs in <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">real-time</a>, which is something that not all biometric <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">face recognition</a> software vendors offer.</p>\n<p>In a more technical definition, <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">facial recognition</a> is a technique for identifying or validating a person’s identification based on their <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">face</a>. It records, analyses, and compares patterns depending on the individual’s <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">facial</a> <a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">features</a>.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/7998/0*Ze-6q475qIVVzC5n\" alt=\"Photo by [Markus Winkler](https://unsplash.com/@markuswinkler?utm_source=medium&#x26;utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&#x26;utm_medium=referral)\"><em>Photo by <a href=\"https://unsplash.com/@markuswinkler?utm_source=medium&#x26;utm_medium=referral\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Markus Winkler</a> on <a href=\"https://unsplash.com?utm_source=medium&#x26;utm_medium=referral\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unsplash</a></em></p>\n<p><a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Face detection</a> is a critical stage in recognising and finding human faces in pictures and videos.</p>\n<p><a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Face capture</a> converts analogue information (a face) to a collection of digital data (or vectors) depending on the individual’s facial characteristics.</p>\n<p><a href=\"https://www.electronicid.eu/en/blog/post/face-recognition/en\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Face matching</a> determines if two faces belong to the same individual.</p>\n<h2 id=\"using-machine-learning-for-facial-recognition\" style=\"position:relative;\"><a href=\"#using-machine-learning-for-facial-recognition\" aria-label=\"using machine learning for facial recognition permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine Learning</a> for Facial Recognition</h2>\n<p><img src=\"https://cdn-images-1.medium.com/max/15904/0*5cZs7tmaRFgF0F3H\" alt=\"Photo by [Arseny Togulev](https://unsplash.com/@tetrakiss?utm_source=medium&#x26;utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&#x26;utm_medium=referral)\"><em>Photo by <a href=\"https://unsplash.com/@tetrakiss?utm_source=medium&#x26;utm_medium=referral\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Arseny Togulev</a> on <a href=\"https://unsplash.com?utm_source=medium&#x26;utm_medium=referral\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Unsplash</a></em></p>\n<p>The idea of using <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">machine learning</a> for facial recognition is entirely driven by the quality and quantity of data that the machine learning model is trained on.</p>\n<p>At its core, facial recognition is based on mathematical AI and <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">machine learning algorithms</a> that evaluate face landmarks or facial features to match them to photos of persons in a pre-existing database.</p>\n<p>In this article, we will look at how a simple real-time facial recognition tool is implemented.</p>\n<p>The complete code can be found in the link below:\n<a href=\"https://github.com/Prem95/face-liveness-detector\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>GitHub - Prem95/face-liveness-detector: Realtime Face Anti Spoofing with Face Detector based on</strong></a></p>\n<h2 id=\"why-build-this\" style=\"position:relative;\"><a href=\"#why-build-this\" aria-label=\"why build this permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why Build This?</h2>\n<p>Face anti-spoofing systems has lately attracted increasing attention due to its important role in securing face recognition systems from fraudulent attacks. This project aims to provide a starting point in recognising real and fake faces based on a model that is trained with publicly available dataset</p>\n<h2 id=\"where-to-use\" style=\"position:relative;\"><a href=\"#where-to-use\" aria-label=\"where to use permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Where to use?</h2>\n<p>This Face Anti Spoofing detector can be used in many different systems that needs realtime facial recognition with facial landmarks. Potentially could be used in security systems, biometrics, attendence systems and etc.</p>\n<p>Can be integrated with hardware systems for application in offices, schools, and public places for various use cases.</p>\n<h2 id=\"requirements\" style=\"position:relative;\"><a href=\"#requirements\" aria-label=\"requirements permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Requirements</h2>\n<p>For this project, we need OpenCV and Tensorflow so let’s install them.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ pip install opencv-python\n$ pip install tensorflow</code></pre></div>\n<h2 id=\"installation\" style=\"position:relative;\"><a href=\"#installation\" aria-label=\"installation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Installation</h2>\n<p>Clone the repo</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git clone [https://github.com/Prem95/face-liveness-detector.git](https://github.com/Prem95/face-liveness-detector.git)</code></pre></div>\n<p>Change your directory to the cloned repo</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ cd face-liveness-detector</code></pre></div>\n<p>Run the following command in your terminal</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ pip install -r requirements.txt</code></pre></div>\n<h2 id=\"usage\" style=\"position:relative;\"><a href=\"#usage\" aria-label=\"usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Usage</h2>\n<p>Run the following command in your terminal</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ python3 main.py</code></pre></div>\n<h2 id=\"facial-recognition-model\" style=\"position:relative;\"><a href=\"#facial-recognition-model\" aria-label=\"facial recognition model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Facial Recognition Model</h2>\n<p>The Facial Recognition model (<strong>anti-spoofing.h5</strong>) is trained using Tensorflow from publicly available datasets.</p>\n<p>Below listed are the data sources that the model is trained on:</p>\n<p><strong>CASIA</strong>: <a href=\"https://github.com/namtpham/casia2groundtruth\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/namtpham/casia2groundtruth</a></p>\n<p><strong>OULU</strong>: <a href=\"https://sites.google.com/site/oulunpudatabase/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://sites.google.com/site/oulunpudatabase/</a></p>\n<p><strong>NUAA</strong>: <a href=\"http://parnec.nuaa.edu.cn/_upload/tpl/02/db/731/template731/pages/xtan/NUAAImposterDB_download.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://parnec.nuaa.edu.cn/<em>upload/tpl/02/db/731/template731/pages/xtan/NUAAImposterDB</em>download.html</a></p>\n<p><strong>3DDFA</strong>: <a href=\"https://github.com/cleardusk/3DDFA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/cleardusk/3DDFA</a> (Face Detector Library)</p>\n<p><em>Please obtain the necessary permissions before using the datasets above</em></p>\n<h2 id=\"face-detector\" style=\"position:relative;\"><a href=\"#face-detector\" aria-label=\"face detector permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Face Detector</h2>\n<p>The open-source library detects the facial landmarks and the number of faces present in the viewpoint. To check how is it implemented, you can check out the repo below:\n<a href=\"https://github.com/cleardusk/3DDFA\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"><strong>GitHub - cleardusk/3DDFA: The PyTorch improved version of TPAMI 2017 paper: Face Alignment in Full…</strong></a></p>\n<p>Using the face detector, we can obtain the facial landmarks of the faces that are detected.</p>\n<h2 id=\"building-the-realtime-facial-recognition-tool\" style=\"position:relative;\"><a href=\"#building-the-realtime-facial-recognition-tool\" aria-label=\"building the realtime facial recognition tool permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><strong>Building the Realtime Facial Recognition Tool</strong></h2>\n<h3 id=\"face-detector-1\" style=\"position:relative;\"><a href=\"#face-detector-1\" aria-label=\"face detector 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Face Detector</h3>\n<p>The class below will return the face and facial landmarks such as eyes, nose, ears and mouth.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">class FaceDetector(object):\n\n    def __call__(self, img, dense_flag=False):\n\n        faces = face_boxes(img)\n        param_lst, roi_box_lst = tddfa(img, faces)\n        landmarks = tddfa.recon_vers(param_lst, roi_box_lst, dense_flag=dense_flag)\n        faces = np.array([[top, right, bottom, left] for left, top, right, bottom, _ in faces]).astype(int).tolist()\n        return faces, landmarks</code></pre></div>\n<h3 id=\"video-feed\" style=\"position:relative;\"><a href=\"#video-feed\" aria-label=\"video feed permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Video Feed</h3>\n<p>Using OpenCV, we can provide the webcam feed directly to the face detector to return the facial landmarks and number of faces present from the feed.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># Read the video stream\nvideo = cv2.VideoCapture(0)\nwhile True:\n    if not video.isOpened():\n        print(\"[ERROR] Cannot find webcam\")\n        pass\n\n    # Read the feed from webcam\n    ret, frame = video.read()\n\n    # Call face detector to obtain face image\n    frame_bgr = frame[..., ::-1]\n    boxes = face_detector(np.array(frame_bgr))</code></pre></div>\n<h3 id=\"loading-the-trained-model\" style=\"position:relative;\"><a href=\"#loading-the-trained-model\" aria-label=\"loading the trained model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loading the trained model</h3>\n<p>The model is trained on publically available datasets using Keras with TensorFlow as the backend. Loading the model can quickly be done as below:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">def load_keras_model(model_path):\n    try:\n        model = tf.keras.models.load_model(model_path, custom_objects={\"lr\": lambda x: x, \"SparseCategoricalFocalLoss\": lambda x: x})\n        model.status = 0\n    except Exception as e:\n        class empty_model(object):\n            def __init__(self):\n                self.status = 600\n        model = empty_model()\n        print('[ERROR] Model failed to load. Check file path.')\n        sys.exit()\n    return model</code></pre></div>\n<h3 id=\"calculating-the-face-score\" style=\"position:relative;\"><a href=\"#calculating-the-face-score\" aria-label=\"calculating the face score permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Calculating the Face Score</h3>\n<p>The trained model is used to detect if the faces that it sees are real or fake. By default, it has a threshold of 0.7, meaning that if the score is above 0.7, the model is confident that the face that appears on the video feed is a real face.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">def load_keras_model(model_path):\n    try:\n        model = tf.keras.models.load_model(model_path, custom_objects={\"lr\": lambda x: x, \"SparseCategoricalFocalLoss\": lambda x: x})\n        model.status = 0\n    except Exception as e:\n        class empty_model(object):\n            def __init__(self):\n                self.status = 600\n        model = empty_model()\n        print('[ERROR] Model failed to load. Check file path.')\n        sys.exit()\n    return model</code></pre></div>\n<p><img src=\"https://cdn-images-1.medium.com/max/2000/1*fPF8PYkSYRjt6umNh_5rkg.png\" alt=\"Real Face Detection. Image source: Author (Please ignore my background)\"><em>Real Face Detection. Image source: Author (Please ignore my background)</em></p>\n<h3 id=\"displaying-the-face-and-face-score\" style=\"position:relative;\"><a href=\"#displaying-the-face-and-face-score\" aria-label=\"displaying the face and face score permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Displaying the Face and Face Score</h3>\n<p>Once we obtain the probability of the detected face, we can use OpenCV to add the bounding box directly on the face itself.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># Check if face is present\nn = len(boxes[0])\nif n == 0:\n    cv2.putText(frame, \"Faces: %s\" % (n), (500, 30),\n                cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 200), 2)\nelse:\n    cv2.putText(frame, \"Faces: %s\" % (n), (500, 30), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 200), 2)\n    face_image = VideoUtils.get_liveness_score(frame, boxes[0])\n    liveness_score = (np.round(model.predict(face_image)[:, 1].tolist()[0], 3))\n    cv2.putText(frame, \"Liveness: %s\" % liveness_score, (20, 30), cv2.FONT_HERSHEY_DUPLEX,0.7, (0, 0, 200) if liveness_score &lt; 0.7 else (0, 200, 0), 1)\n    cv2.rectangle(frame, (boxes[0][0][3], boxes[0][0][2]), (boxes[0][0][1], boxes[0][0][0]), (255, 0, 0), 2)\n\ncv2.imshow(\"FAS Detector\", frame)\n\n# Reduce the frames for a more slower detection\nkey = cv2.waitKey(15)\nif key == ord('q'):\n    break</code></pre></div>\n<p><img src=\"https://cdn-images-1.medium.com/max/2000/1*ipXGIfTUpVFw20iBwPMMIg.png\" alt=\"Fake Face Detection. Image source: Author (Please ignore my background)\"><em>Fake Face Detection. Image source: Author (Please ignore my background)</em></p>\n<h3 id=\"bonus-drawing-facial-landmark\" style=\"position:relative;\"><a href=\"#bonus-drawing-facial-landmark\" aria-label=\"bonus drawing facial landmark permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bonus: Drawing Facial Landmark</h3>\n<p>Once the face landmark is obtained, we can overlap the face landmark points on the detected face.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/2000/1*1D6WJaPw-XxjTneYMXT7pg.png\" alt=\"Face Landmarks. Image source: Author (Please ignore my background)\"><em>Face Landmarks. Image source: Author (Please ignore my background)</em></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">def draw_face_landmark(img_ori, pts, box=None, size=1):\n  GREEN = (0, 255, 0)\n  img = img_ori.copy()\n  n = pts.shape[1]\n  if n &lt;= 106:\n      for i in range(n):\n          cv2.circle(img, (int(round(pts[0, i])), int(round(pts[1, i]))), size, GREEN, -1)\n  else:\n      sep = 1\n      for i in range(0, n, sep):\n          cv2.circle(img, (int(round(pts[0, i])), int(round(pts[1, i]))), size, GREEN, 1)\n  if box is not None:\n      left, top, right, bottom = np.round(box).astype(np.int32)\n      left_top = (left, top)\n      right_top = (right, top)\n      right_bottom = (right, bottom)\n      left_bottom = (left, bottom)\n      cv2.line(img, left_top, right_top, GREEN, 1, cv2.LINE_AA)\n      cv2.line(img, right_top, right_bottom, GREEN, 1, cv2.LINE_AA)\n      cv2.line(img, right_bottom, left_bottom, GREEN, 1, cv2.LINE_AA)\n      cv2.line(img, left_bottom, left_top, GREEN, 1, cv2.LINE_AA)\n\n  return img</code></pre></div>\n<h2 id=\"in-recap\" style=\"position:relative;\"><a href=\"#in-recap\" aria-label=\"in recap permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>In Recap</h2>\n<p>Today, the amount of digital data generated is enormous thanks to smart devices and the Internet of Things.</p>\n<p>This data can be analysed to make intelligent decisions based on patterns, and <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a> helps to do that while not being limited to the above applications.</p>\n<p>Using <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a>, facial recognition related tasks can be improved by using state of the art research techniques to solve most problems nowadays related to security, etc.</p>\n<p><a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a>-based models can extract patterns from massive amounts of data, which humans cannot do.</p>\n<p>We cannot retain everything in memory or perform redundant computations for hours and days to develop exciting patterns. As per estimates, the Machine learning market will grow to reach <strong>USD 8.81 billion</strong> by 2022.</p>\n<p>In the end, <a href=\"https://medium.com/geekculture/what-do-you-have-to-know-about-machine-learning-in-2021-d00b30aa5f11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Machine learning</a> is here to improve our lives beyond what we can imagine.</p>\n<p>It is up to us to harness the power and make the right choices important to the people surrounding us and us.</p>","fields":{"slug":"/posts/realtime-face-antispoofing-detection-using-python","tagSlugs":["/tag/python/","/tag/deep-learning/","/tag/face-recognition/","/tag/tensor-flow/"]},"frontmatter":{"date":"2021-10-23","description":"We will be looking at how to build a realtime face anti spoofing detection tool using TensorFlow and Python","tags":["Python","Deep Learning","Face Recognition","TensorFlow"],"title":"Realtime Face Anti-Spoofing Detection using Python and TensorFlow","socialImage":null}}},"pageContext":{"slug":"/posts/realtime-face-antispoofing-detection-using-python"}},"staticQueryHashes":["251939775","2549761526","401334301"]}